# CoffeeChat

opensource im with server(go) and client(flutter+swift)

## News

æœ‰ç½‘å‹åœ¨Issuesè¯¢é—®åç»­æ›´æ–°ä¸€äº‹ï¼Œè¿™é‡Œå›å¤ä¸€ä¸‹ï¼š
> ä»Šå¹´äº‹æƒ…æ¯”è¾ƒå¤šï¼Œæ‰€ä»¥è¿›å±•ååˆ†ç¼“æ…¢ï¼Œä¼šä¸ä¼šæ”¾å¼ƒè¿™ä¸ªé¡¹ç›®æˆ‘ä¹Ÿä¸èƒ½è‚¯å®šï¼Œä¸»è¦æ˜¯ä½œè€…ç²¾åŠ›æœ‰é™ï¼Œè¯·å¤§å®¶åŸè°…ã€‚å‘èµ·è¿™ä¸ªé¡¹ç›®çš„åˆè¡·ï¼Œæ˜¯ä¸ºäº†æ›´æ·±å…¥çš„å­¦ä¹ IMæœåŠ¡ç«¯å¼€å‘ï¼Œå¦‚æœæœ‰æ›´å¥½çš„å¼€æºgoè¯­è¨€å®ç°çš„imé¡¹ç›®ï¼Œæˆ‘å¯èƒ½ä¼šè€ƒè™‘ä½œä¸ºContributorå‚ä¸å…¶ä¸­ã€‚ä»ç›®å‰æ¥çœ‹ï¼ŒOpenIMå¯èƒ½æ€§å¾ˆå¤§ã€‚

æœ€åï¼Œæ”¾å‡ºæœ€è¿‘çš„ä¸€äº›åŠ¨æ€ä»¥æ„Ÿè°¢å¤§å®¶çš„å…³å¿ƒã€‚

æœ€æ–°åŠ¨æ€ï¼š
- è‡³ä»Š: ç”Ÿå‘½ä¸æ¯ï¼Œæ¢ç´¢ä¸æ­¢ğŸ’ªğŸ’ª
- 2021/08: ä½œè€…æœ€è¿‘åœ¨è€ƒè™‘è·³æ§½ï¼Œæ•…ç²¾åŠ›ä¸»è¦æ”¾åœ¨ç ”ç©¶[OpenIM](https://github.com/OpenIMSDK/Open-IM-Server)ï¼Œå­¦ä¹ Kafkaï¼Œå¾®æœåŠ¡ï¼Œæ”¶ä»¶ç®±ï¼ŒEtcdï¼ŒDockerï¼ŒK8Sç­‰ä½¿ç”¨ï¼Œæå‡æŠ€æœ¯æ·±åº¦ã€‚
- 2021/03 - 07: å¼€å‘QTå®¢æˆ·ç«¯å’ŒC++è·¨å¹³å°SDKï¼Œå—é™äºç²¾åŠ›è¿›å±•ç¼“æ…¢ã€‚
- 2021/02: ä½¿ç”¨sketchè®¾è®¡win+macå®¢æˆ·ç«¯ç•Œé¢ã€‚

æ€»ç»“ï¼š
- `2021`: ä¸»è¦ç²¾åŠ›åœ¨æ¢ç´¢ç™¾ä¸‡çº§çš„æ¶æ„ï¼ŒC++è·¨å¹³å°SDKï¼ŒQTï¼ŒGoå¾®æœåŠ¡ï¼ŒDockerï¼ŒEtcdç­‰ç­‰ï¼Œcoffeechatå‡ ä¹æ²¡æœ‰æ›´æ–°
- `2020`: è¿™ä¸€å¹´coffeechatä¸æ–­å®Œå–„ï¼Œä½œè€…ä¸»è¦åœ¨å­¦ä¹ ioså¼€å‘ï¼Œå®ç°ç®€å•ios app
- `2019/08`: coffeechatè¯ç”Ÿï¼Œå­¦ä¹ flutterï¼Œå®ç°ç®€å•flutterå®¢æˆ·ç«¯ï¼Œåç»­å› ä¸ºflutterèŠå¤©ç•Œé¢ä¸‹æ‹‰æ„Ÿè§‰æ•ˆæœä¸ç†æƒ³æ”¾å¼ƒ

## Preview

### flutter

see [CoffeeChat-Flutter](https://github.com/xmcy0011/CoffeeChat-Flutter)

### swift
![screenshot](./images/swift/screenshot.png)  

## Features

### è®¾è®¡

- [x] æ¶æ„è®¾è®¡ï¼šå‚è€ƒç“œå­ IM
- [x] åè®®è®¾è®¡ï¼šå‚è€ƒç½‘æ˜“äº‘ IMã€ç¯ä¿¡ã€TeamTalk
- [x] æ•°æ®åº“è®¾è®¡
- [x] æ¶ˆæ¯åˆ†è¡¨å­˜å‚¨è®¾è®¡
- [x] IM æ¶ˆæ¯ ID ç”Ÿæˆè®¾è®¡

### å•èŠç¾¤èŠ

- [x] flutter å®¢æˆ·ç«¯
- [x] å•èŠ
- [x] å¤šåª’ä½“æ¶ˆæ¯ï¼šæ–‡æœ¬
- [x] ä¼šè¯åˆ—è¡¨
- [x] æ¶ˆæ¯å­˜å‚¨
- [x] å†å²æ¶ˆæ¯
- [x] æ¼«æ¸¸æ¶ˆæ¯ï¼ˆç”¨æˆ·åˆ‡æ¢åˆ°ä»»ä½•è®¾å¤‡éƒ½å¯ä»¥è¯»å–åˆ°æœ€è¿‘çš„å†å²æ¶ˆæ¯ï¼‰
- [ ] ç¦»çº¿æ¶ˆæ¯ï¼ˆç”¨æˆ·ç¦»çº¿é‡æ–°ä¸Šçº¿åæ”¶åˆ°æœ€è¿‘ 30 å¤©çš„æœªè¯»æ¶ˆæ¯ï¼‰
- [ ] å¤šåª’ä½“æ¶ˆæ¯ï¼šè¡¨æƒ…
- [ ] å¤šåª’ä½“æ¶ˆæ¯ï¼šå›¾ç‰‡
- [x] æœªè¯»æ¶ˆæ¯è®¡æ•°
- [ ] æ¶ˆæ¯æ¨é€(APNS)

- [ ] ç¾¤èŠ
- [ ] ç¾¤æœ€é«˜äººæ•°ï¼š200
- [ ] ç¾¤ç®¡ç†ï¼šç¾¤ä¸»ã€åŠ äººã€è¸¢äºº
- [ ] ç¾¤æ¶ˆæ¯å…æ‰“æ‰°
- [ ] ç¾¤æˆå‘˜ç®¡ç†

### æœåŠ¡ç«¯ç‰¹æœ‰

- [ ] è´Ÿè½½å‡è¡¡
- [ ] åŒæœºå®¹ç¾
- [ ] æ€§èƒ½å‹æµ‹ Benchmark
- [ ] ä¸šåŠ¡ç›‘æ§
- [ ] Redis é›†ç¾¤
- [ ] docker
- [ ] é˜¿é‡Œäº‘OSSå¯¹è±¡å­˜å‚¨æ¥å…¥ï¼ˆ40GBå­˜å‚¨ä¸€å¹´7å—ï¼Œæ¯æœˆ100GBä¸‹è¡Œå¸¦å®½ä¸€å¹´200ï¼‰
- [ ] antispam

## å®¢æˆ·ç«¯ç‰¹æœ‰

- [ ] æ¶ˆæ¯æ¨é€æé†’ï¼ˆç³»ç»Ÿé€šçŸ¥æ æ¶ˆæ¯æé†’ï¼‰
- [ ] æ¶ˆæ¯è½¬å‘
- [ ] ç½‘ç»œè¿æ¥çŠ¶æ€
- [ ] å›¾ç‰‡ç®¡ç†å™¨
- [ ] æŸ¥æ‰¾èŠå¤©è®°å½•
- [ ] æ¶ˆæ¯åŒæ­¥ç¼“å­˜
- [x] ä¼šè¯åŒæ­¥ç¼“å­˜
- [ ] å¤´åƒåŒæ­¥ç¼“å­˜
- [ ] æœªè¯»è®¡æ•°æ¡Œé¢è§’æ ‡
- [ ] å…æ‰“æ‰°æ¨¡å¼
- [ ] å›¾ç‰‡å‹ç¼©

### ç‰¹è‰²åŠŸèƒ½

- [ ] é˜…åå³ç„š
- [ ] æ’¤å›
- [ ] æ­£åœ¨è¾“å…¥
- [ ] å·²è¯»å›æ‰§ï¼ˆç”¨æˆ·å‘é€æ¶ˆæ¯ï¼Œè·å–å¯¹æ–¹æ˜¯å¦å·²è¯»çŠ¶æ€ ï¼‰
- [ ] å¤šç»ˆç«¯å·²è¯»åŒæ­¥ï¼ˆåŒä¸ªäº§å“å¤šç»ˆç«¯æƒ…å†µä¸‹ï¼ŒåŒæ­¥æ¶ˆæ¯å·²è¯»æœªè¯»çš„çŠ¶æ€ï¼‰
- [ ] ç«¯åˆ°ç«¯åŠ å¯†
- [ ] é«˜æ¸…è¯­éŸ³æ¶ˆæ¯
- [ ] æ–‡ä»¶ä¸Šä¼ ä¸‹è½½
- [x] è¯­éŸ³é€šè¯(å£°ç½‘FlutterSDK)
- [ ] è§†é¢‘é€šè¯
- [ ] electron è·¨å¹³å°æ¡Œé¢å®¢æˆ·ç«¯
- [x] flutter è·¨å¹³å°ç§»åŠ¨ç«¯
- [ ] swift/iOS å®¢æˆ·ç«¯+SDK
- [ ] kotlin/Android å®¢æˆ·ç«¯+SDK
- [ ] vue/Web å®¢æˆ·ç«¯+SDK

### å®¢æœåŠŸèƒ½

- [ ] å®¢æœä¼šè¯
- [ ] æ¬¢è¿è¯­
- [ ] è‡ªåŠ¨åˆ†é…åœ¨çº¿å®¢æœ
- [ ] å®¢æœæ­£åœ¨è¾“å…¥æé†’
- [ ] å›å¤´å®¢

### æ™ºèƒ½é—®ç­”åŠŸèƒ½

- [ ] AnyQ ç™¾åº¦å¼€æº FAQ é—®ç­”ç³»ç»Ÿæ¥å…¥

### èŠå¤©æœºå™¨äººåŠŸèƒ½

- [ ] å›¾çµæœºå™¨äººæ¥å…¥
- [ ] å°çˆ±æœºå™¨äººæ¥å…¥
- [x] æ€çŸ¥æœºå™¨äººæ¥å…¥
- [x] å¾®ä¿¡æœºå™¨äººæ¥å…¥

## Architecture

æ€»ä½“æ¶æ„:  
![æ€»ä½“æ¶æ„](https://raw.githubusercontent.com/xmcy0011/CoffeeChat/master/images/architecture.png)

é€»è¾‘æ¶æ„:  
![é€»è¾‘æ¶æ„](https://raw.githubusercontent.com/xmcy0011/CoffeeChat/master/images/architecture2.png)

æ¨¡å—æ¶æ„:  
![æ¨¡å—æ¶æ„](https://raw.githubusercontent.com/xmcy0011/CoffeeChat/master/images/structure-v2.png)

å•èŠæ¨¡å—äº¤äº’å›¾:
![å•èŠ](https://raw.githubusercontent.com/xmcy0011/CoffeeChat/master/images/seq-c2c.png)

See More [architecture](https://github.com/xmcy0011/CoffeeChat/blob/master/docs/02-%E6%9E%B6%E6%9E%84%E5%92%8C%E5%8D%8F%E8%AE%AE%E8%AE%BE%E8%AE%A1.md)

## Quick Start

### Build

> PSï¼šè¯·åˆ‡æ¢åˆ°**master**åˆ†æ”¯ï¼Œç¼–è¯‘å’Œè¿è¡Œï¼

#### client

ç›®å‰ä»…æ”¯æŒ Flutter å®¢æˆ·ç«¯ï¼Œåœ¨ ios11 æ¨¡æ‹Ÿå™¨ä¸‹æµ‹è¯•é€šè¿‡ã€‚ä»…æµ‹è¯•äº†ç™»å½•ç™»å‡ºã€å•èŠã€å‘æ–‡æœ¬ã€æœªè¯»æ¶ˆæ¯è®¡æ•°ç­‰åŠŸèƒ½ã€‚

1. Flutter å®‰è£…ï¼Œè¯·å‚è€ƒ [å®˜ç½‘](https://flutter.cn/docs/get-started/install)
2. ä¸‹è½½ IntelliJ IDEA Ultimateï¼Œ[é“¾æ¥](https://www.jetbrains.com/idea/)
3. ä½¿ç”¨ idea æ‰“å¼€ cc_flutter_app
4. æ‰“å¼€ç»ˆç«¯ï¼Œåˆå§‹åŒ–é¡¹ç›®ï¼Œå‘½ä»¤å¦‚ä¸‹

```bash
cd client/cc_flutter_app
flutter pub get
```

5. ç‚¹å‡» Open IOS Simulatorï¼Œç­‰å¾…æ¨¡æ‹Ÿå™¨å¯åŠ¨
6. ç‚¹å‡» Run å›¾æ ‡

#### server(ä»¥ mac ç¯å¢ƒä¸ºä¾‹)

> 2020.04.20 æ›´æ–°ï¼šä½¿ç”¨go modåŒ…ç®¡ç†å·¥å…·ä»£æ›¿depã€‚

1. å®‰è£…golangï¼ˆæ¨è**go1.13**ä»¥ä¸Šï¼Œå®‰è£…æ–¹æ³•è¯·ä»¥ [å®˜ç½‘](https://golang.google.cn/dl/) ä¸ºå‡†ï¼‰

```bash
$ brew isntall golang # å®‰è£…go
$ vim ~/.bash_profile # è®¾ç½®goç¯å¢ƒå˜é‡

export GOROOT=/usr/local/Cellar/go/1.16.3/libexec
# è‡ªgo1.13é»˜è®¤å¯ç”¨go modåï¼ŒGOPATHå¯ä»¥ä¸åœ¨é…ç½®
#export GOPATH="/Users/xmcy0011/repo/go" # ä½¿ç”¨go modåï¼Œä»£ç ä¸èƒ½å­˜æ”¾åˆ°gopathä¸‹ï¼Œè¯·æ³¨æ„ã€‚
export GOBIN=$GOROOT/bin
export PATH=$PATH:$GOBIN:$GOPATH/bin 

$ source ~/.bash_profile # ç”Ÿæ•ˆ
$ go env                 # ç¡®è®¤gorootå’Œgopathæ­£ç¡®

$ unset GOPROXY          # go modæœ‰äº›åŒ…æ‹‰ä¸ä¸‹æ¥ï¼Œå¯ä»¥é…ç½®GOPROXYã€‚ä½†æ˜¯ï¼Œå¯¹go getæ— æ•ˆğŸ˜­
$ go env -w GOPROXY=https://goproxy.cn,direct
```

2. git clone
```bash
$ cd /Users/xmcy0011/repo #æ³¨æ„ä¸æ˜¯gopathè·¯å¾„ï¼
$ mkdir github
$ cd github
$ git clone https://github.com/xmcy0011/CoffeeChat.git
```

3. build & run
- æ‰‹å·¥æ–¹å¼
```bash
# gate ç½‘å…³æœåŠ¡ç¼–è¯‘
$ cd server/src/app/im_gate
$ go build -v
$ ./im_gate -conf=./gate-example.toml

# logic é€»è¾‘æœåŠ¡ç¼–è¯‘
$ cd server/src/app/im_logic
$ go build -v
$ ./im_logic -conf=./logic-example.toml
```
- ä½¿ç”¨è„šæœ¬
```bash
$ cd server/src
$ chmod 777 build.sh
# ç¼–è¯‘å¹¶æ‰“åŒ…
$ ./build.sh version 2021-04-20
# è§£å‹ï¼Œé€šè¿‡./restart.sh ./stop.shç­‰è„šæœ¬å¯åŠ¨å’Œåœæ­¢æœåŠ¡
$ tar -zxvf coffeechat.2021-04-20.tar.gz
```

### Run

1. client see [here](https://github.com/xmcy0011/CoffeeChat/blob/master/client/cc_flutter_app/README.md)
2. server see [here](https://github.com/xmcy0011/CoffeeChat/blob/master/server/src/README.md)

### Document

1. [äº§å“ä»‹ç»](https://github.com/xmcy0011/CoffeeChat/blob/master/docs/01-%E4%BA%A7%E5%93%81%E4%BB%8B%E7%BB%8D.md)
2. [æ¶æ„å’Œåè®®è®¾è®¡](https://github.com/xmcy0011/CoffeeChat/blob/master/docs/02-%E6%9E%B6%E6%9E%84%E5%92%8C%E5%8D%8F%E8%AE%AE%E8%AE%BE%E8%AE%A1.md)
3. [æ¶ˆæ¯åˆ†è¡¨å­˜å‚¨](https://github.com/xmcy0011/CoffeeChat/blob/master/docs/03-%E6%B6%88%E6%81%AF%E5%88%86%E8%A1%A8%E5%AD%98%E5%82%A8.md)
4. [IM æ¶ˆæ¯ ID ç”ŸæˆåŸç†å’Œå¸¸è§æŠ€æœ¯éš¾ç‚¹](https://github.com/xmcy0011/CoffeeChat/blob/master/docs/04_IM%e5%b8%b8%e8%a7%81%e6%8a%80%e6%9c%af%e9%9a%be%e7%82%b9.md)
5. [è¿›åº¦è®¡åˆ’](https://github.com/xmcy0011/CoffeeChat/blob/master/docs/05-%E8%BF%9B%E5%BA%A6%E8%AE%A1%E5%88%92.md)
6. [MQåœ¨IMä¸­çš„å®è·µå’Œé€‰å‹](https://github.com/xmcy0011/CoffeeChat/blob/master/docs/06_MQ%e5%9c%a8IM%e4%b8%ad%e7%9a%84%e5%ae%9e%e8%b7%b5.md)

## Contact

email:xmcy0011@sina.com

## LICENSE

CoffeeChat is provided under the [mit license](https://github.com/xmcy0011/CoffeeChat/blob/master/LICENSE).